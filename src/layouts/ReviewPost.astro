---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Comments from '../components/Comments.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import '../styles/layouts/review-post.css';
import '../styles/layouts/review-post-variants.css';

type Props = CollectionEntry<'reviews'>['data'] & {
	commentThreadId?: string;
};

const {
	title,
	description,
	pubDate,
	updatedDate,
	heroImage,
	theme,
	feature,
	comments = false,
	commentThreadId,
} = Astro.props;

const reviewTheme = theme ?? 'default';
const isFeatured = feature ?? false;
const usesVariantFonts = reviewTheme === 'e33';

---

<html lang="en" data-theme={reviewTheme}>
	<head>
		<BaseHead title={title} description={description} image={heroImage} variantFonts={usesVariantFonts} />
	</head>

	<body
		class="review-post"
		data-theme={reviewTheme}
		data-review-variant={reviewTheme}
		data-featured={isFeatured ? 'true' : 'false'}
	>
		<Header />
		<main>
			<article>
				<div class="hero-image">
					{heroImage && <Image width={1020} height={510} src={heroImage} alt="" />}
					<div class="hero-title-wrap">
						<div class="hero-eyebrow">
							<span>Review</span>
							<span class="hero-eyebrow-dot" aria-hidden="true">&bull;</span>
							<span><FormattedDate date={pubDate} /></span>
						</div>
						<h1 class="hero-title">{title}</h1>
					</div>
				</div>
				<div class="prose">
					{
						updatedDate && (
							<div class="title title-meta-only">
								<div class="date">
									<div class="last-updated-on">
										Last updated on <FormattedDate date={updatedDate} />
									</div>
								</div>
							</div>
						)
					}
					<slot />
				</div>
			</article>
			{comments && <Comments threadId={commentThreadId} />}
		</main>
		<Footer />
	</body>
</html>
