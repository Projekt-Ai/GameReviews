---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Platform {
	name: string;
	played?: boolean;
}

interface GotyEntry {
	year: number;
	title: string;
	platforms: Platform[];
	genres: string[];
	release: string;
	blurb: string;
	slug: string;
	credit: string;
	image: ImageMetadata;
}

const { entry, eager = false } = Astro.props as { entry: GotyEntry; eager?: boolean };
---

<article class={`featured article goty year-${entry.year}`}>
	<div class="article-background">
		<Image
			src={entry.image}
			alt={`${entry.title} artwork`}
			width={1200}
			loading={eager ? 'eager' : 'lazy'}
			fetchpriority={eager ? 'high' : 'auto'}
		/>
	</div>
	<div class="article-overlay"></div>

	<div class={`ribbon year-${entry.year}`}>
		<span class="ribbon-text">{entry.year}</span>
	</div>

	<div class="article-content">
		<p class="article-label">My Game of the Year {entry.year}</p>
		<h2 class="article-title">{entry.title}</h2>

		<p class="article-meta">
			{
				entry.platforms.map((platform, i) => (
					<>
						<span class={platform.played ? 'my-platform' : undefined}>{platform.name}</span>
						{i < entry.platforms.length - 1 && <span class="platform-separator"> / </span>}
					</>
				))
			}
		</p>

		<p class="article-meta">{entry.genres.join(' · ')} · {entry.release}</p>
		<p class="article-blurb">{entry.blurb}</p>
		<a href={`/reviews/${entry.slug}`} class="read-more">Read More</a>
	</div>

	<p class="image-credit">{entry.credit}</p>
</article>
